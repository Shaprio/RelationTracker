{# templates/mainPage.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}
    Dashboard - Main Page
{% endblock %}

{% block stylesheets %}


{% endblock %}

{% block content %}
    <div class="top-bar">
        <div>
            <div class="welcome-box">
                Hello, {{ app.user.name }}! It's good to see you again.
            </div>
        </div>
    </div>

    <div class="main-sections">
        <div class="left-column">
            <div class="card">
                <h3>Events This Week</h3>
                <div class="item-list">
                    {% for e in eventsThisWeek %}
                        <div class="list-item">{{ e.title }} â€” {{ e.date|date('Y-m-d H:i') }}</div>
                    {% else %}
                        <p>No events found for this week.</p>
                    {% endfor %}
                </div>
            </div>
            <div class="card">
                <h3>Birthday Events This Month</h3>
                <div class="item-list">
                    {% for b in birthdayEvents %}
                        <div class="list-item">{{ b.title }} on {{ b.startDate|date('Y-m-d') }}</div>
                    {% else %}
                        <p>No birthdays this month.</p>
                    {% endfor %}
                </div>
            </div>
            <div class="card">
                <h3>Contacts to Reconnect</h3>
                <div class="item-list">
                    {% for c in staleContacts %}
                        <div class="list-item">{{ c.name }} - Last interaction over a month ago</div>
                    {% else %}
                        <p>All contacts are up to date.</p>
                    {% endfor %}
                </div>
            </div>
        </div>
        <div class="right-column">
            <div class="calendar-box">
                <h3>Calendar</h3>
                <div id="calendar"></div>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js'></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let calendarEl = document.getElementById('calendar');
            if (!calendarEl) {
                console.error('Calendar element not found');
                return;
            }

            let calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                themeSystem: 'bootstrap5', // Dla Bootstrap 5
                headerToolbar: {
                    left: '',
                    center: 'title',
                    right: ''
                },

            });

            calendar.render();
        });

    </script>
{% endblock %}
